(function(hwkuum){(function(){String.fromCharCode(117,115,101,32,115,116,114,105,99,116);const config={storageKey: String.fromCharCode(117,108,104,95,97,98,95,116,101,115,116,115),cookiePrefix: String.fromCharCode(117,108,104,95,97,98,95),cookieDays: 30,apiEndpoint: null,defaultTrafficSplit: 50,persistAssignment: true,debug: false,trackingEnabled: true};let state={initialized: false,tests:{},assignments:{}};function setCookie(name,value,days){const expires=new Date(Date.now()+days*864e5).toUTCString();document.cookie=name+'='+encodeURIComponent(value)+String.fromCharCode(59,101,120,112,105,114,101,115,61)+expires+String.fromCharCode(59,112,97,116,104,61,47);}function getCookie(name){return document.cookie.split(';').reduce((r,v)=>{const parts=v.split('=');return parts[0]===name ? decodeURIComponent(parts[1]): r;},'');}function generateVisitorId(){return 'v_'+Math.random().toString(36).substr(2,9)+'_'+Date.now().toString(36);}function getVisitorId(){let visitorId=localStorage.getItem(String.fromCharCode(117,108,104,95,118,105,115,105,116,111,114,95,105,100))||getCookie(String.fromCharCode(117,108,104,95,118,105,115,105,116,111,114,95,105,100));if(!visitorId){visitorId=generateVisitorId();localStorage.setItem(String.fromCharCode(117,108,104,95,118,105,115,105,116,111,114,95,105,100),visitorId);setCookie(String.fromCharCode(117,108,104,95,118,105,115,105,116,111,114,95,105,100),visitorId,365);}return visitorId;}function hashString(str){let hash=0;for(let i=0;i<str.length;i++){const char=str.charCodeAt(i);hash=((hash<<5)-hash)+char;hash=hash&hash;}return Math.abs(hash);}function log(...args){if(config.debug){console.log(String.fromCharCode(91,65,66,84,101,115,116,93),...args);}}function trackEvent(eventName,data={}){if(!config.trackingEnabled)return;if(window.UniLiveAnalytics&&typeof window.UniLiveAnalytics.trackEvent===String.fromCharCode(102,117,110,99,116,105,111,110)){window.UniLiveAnalytics.trackEvent(eventName,data);}log(String.fromCharCode(69,118,101,110,116,58),eventName,data);}function createTest(testId,options={}){const test={id: testId,name: options.name||testId,variants: options.variants||[String.fromCharCode(99,111,110,116,114,111,108),String.fromCharCode(118,97,114,105,97,110,116)],weights: options.weights||null,active: options.active!==false,goals: options.goals||[],startDate: options.startDate||Date.now(),endDate: options.endDate||null,results:{impressions:{},conversions:{}}};test.variants.forEach(v=>{test.results.impressions[v]=0;test.results.conversions[v]=0;});state.tests[testId]=test;saveTests();log(String.fromCharCode(84,101,115,116,32,99,114,101,97,116,101,100,58),testId,test);return test;}function getVariant(testId){const test=state.tests[testId];if(!test){log(String.fromCharCode(84,101,115,116,32,110,111,116,32,102,111,117,110,100,58),testId);return null;}if(!test.active){log(String.fromCharCode(84,101,115,116,32,110,111,116,32,97,99,116,105,118,101,58),testId);return test.variants[0];}if(test.endDate&&Date.now()>test.endDate){log(String.fromCharCode(84,101,115,116,32,101,110,100,101,100,58),testId);return test.variants[0];}const cookieName=config.cookiePrefix+testId;let assignment=state.assignments[testId]||getCookie(cookieName);if(assignment&&test.variants.includes(assignment)){log('Returning cached assignment:',testId,assignment);return assignment;}const visitorId=getVisitorId();const hash=hashString(visitorId+testId);if(test.weights){let cumulative=0;const roll=hash % 100;for(let i=0;i<test.variants.length;i++){cumulative+=test.weights[i];if(roll<cumulative){assignment=test.variants[i];break;}}}else{const index=hash % test.variants.length;assignment=test.variants[index];}if(config.persistAssignment){state.assignments[testId]=assignment;setCookie(cookieName,assignment,config.cookieDays);}trackImpression(testId,assignment);log(String.fromCharCode(78,101,119,32,97,115,115,105,103,110,109,101,110,116,58),testId,assignment);return assignment;}function trackImpression(testId,variant){const test=state.tests[testId];if(!test)return;test.results.impressions[variant]=(test.results.impressions[variant]||0)+1;saveTests();trackEvent(String.fromCharCode(97,98,95,105,109,112,114,101,115,115,105,111,110),{testId: testId,variant: variant});if(config.apiEndpoint){sendToApi(String.fromCharCode(105,109,112,114,101,115,115,105,111,110),testId,variant);}}function trackConversion(testId,goalId=String.fromCharCode(100,101,102,97,117,108,116)){const test=state.tests[testId];if(!test)return;const variant=state.assignments[testId]||getCookie(config.cookiePrefix+testId);if(!variant)return;test.results.conversions[variant]=(test.results.conversions[variant]||0)+1;saveTests();trackEvent(String.fromCharCode(97,98,95,99,111,110,118,101,114,115,105,111,110),{testId: testId,variant: variant,goalId: goalId});log(String.fromCharCode(67,111,110,118,101,114,115,105,111,110,32,116,114,97,99,107,101,100,58),testId,variant,goalId);if(config.apiEndpoint){sendToApi(String.fromCharCode(99,111,110,118,101,114,115,105,111,110),testId,variant,goalId);}}async function sendToApi(eventType,testId,variant,goalId=null){if(!config.apiEndpoint)return;try{await fetch(config.apiEndpoint,{method: String.fromCharCode(80,79,83,84),headers:{String.fromCharCode(67,111,110,116,101,110,116,45,84,121,112,101): String.fromCharCode(97,112,112,108,105,99,97,116,105,111,110,47,106,115,111,110)},body: JSON.stringify({type: eventType,testId: testId,variant: variant,goalId: goalId,visitorId: getVisitorId(),timestamp: Date.now()})});}catch(error){log(String.fromCharCode(65,80,73,32,101,114,114,111,114,58),error);}}function getResults(testId){const test=state.tests[testId];if(!test)return null;const results={testId: testId,name: test.name,active: test.active,variants:{},winner: null,confidence: 0};test.variants.forEach(variant=>{const impressions=test.results.impressions[variant]||0;const conversions=test.results.conversions[variant]||0;const rate=impressions>0 ?(conversions/impressions)*100 : 0;results.variants[variant]={impressions: impressions,conversions: conversions,conversionRate: rate.toFixed(2)+'%',rawRate: rate};});const variantData=Object.entries(results.variants);if(variantData.length>=2){variantData.sort((a,b)=>b[1].rawRate-a[1].rawRate);const best=variantData[0];const second=variantData[1];if(best[1].impressions>=100&&second[1].impressions>=100){results.winner=best[0];const p1=best[1].rawRate/100;const p2=second[1].rawRate/100;const n1=best[1].impressions;const n2=second[1].impressions;const pooledP=(p1*n1+p2*n2)/(n1+n2);const se=Math.sqrt(pooledP*(1-pooledP)*(1/n1+1/n2));if(se>0){const z=Math.abs(p1-p2)/se;results.confidence=Math.min(99,Math.round((1-Math.exp(-0.5*z*z))*100));}}}return results;}function getAllResults(){const allResults={};Object.keys(state.tests).forEach(testId=>{allResults[testId]=getResults(testId);});return allResults;}function saveTests(){try{localStorage.setItem(config.storageKey,JSON.stringify(state.tests));}catch(e){log(String.fromCharCode(69,114,114,111,114,32,115,97,118,105,110,103,32,116,101,115,116,115,58),e);}}function loadTests(){try{const saved=localStorage.getItem(config.storageKey);if(saved){state.tests=JSON.parse(saved);log(String.fromCharCode(76,111,97,100,101,100,32,116,101,115,116,115,58),Object.keys(state.tests));}}catch(e){log(String.fromCharCode(69,114,114,111,114,32,108,111,97,100,105,110,103,32,116,101,115,116,115,58),e);}}function applyVariant(testId,variantMap){const variant=getVariant(testId);if(!variant||!variantMap[variant])return;const changes=variantMap[variant];if(changes.text){Object.entries(changes.text).forEach(([selector,text])=>{const el=document.querySelector(selector);if(el)el.textContent=text;});}if(changes.html){Object.entries(changes.html).forEach(([selector,html])=>{const el=document.querySelector(selector);if(el)el.innerHTML=html;});}if(changes.style){Object.entries(changes.style).forEach(([selector,styles])=>{const el=document.querySelector(selector);if(el)Object.assign(el.style,styles);});}if(changes.class){Object.entries(changes.class).forEach(([selector,classes])=>{const el=document.querySelector(selector);if(el){if(classes.add)el.classList.add(...classes.add);if(classes.remove)el.classList.remove(...classes.remove);}});}if(changes.attribute){Object.entries(changes.attribute).forEach(([selector,attrs])=>{const el=document.querySelector(selector);if(el){Object.entries(attrs).forEach(([attr,value])=>{el.setAttribute(attr,value);});}});}if(changes.callback&&typeof changes.callback===String.fromCharCode(102,117,110,99,116,105,111,110)){changes.callback(variant);}log(String.fromCharCode(65,112,112,108,105,101,100,32,118,97,114,105,97,110,116,58),testId,variant);return variant;}function runHeadlineTest(testId,selector,headlines){const variantMap={};headlines.forEach((headline,index)=>{const variantName=index===0 ? String.fromCharCode(99,111,110,116,114,111,108) : String.fromCharCode(118,97,114,105,97,110,116,95)+index;variantMap[variantName]={text:{[selector]: headline}};});if(!state.tests[testId]){createTest(testId,{name: String.fromCharCode(72,101,97,100,108,105,110,101,32,84,101,115,116,58,32)+testId,variants: Object.keys(variantMap)});}return applyVariant(testId,variantMap);}function runButtonTest(testId,selector,options){const variantMap={};options.forEach((opt,index)=>{const variantName=index===0 ? String.fromCharCode(99,111,110,116,114,111,108) : String.fromCharCode(118,97,114,105,97,110,116,95)+index;variantMap[variantName]={text: opt.text ?{[selector]: opt.text}: undefined,style: opt.style ?{[selector]: opt.style}: undefined,class: opt.class ?{[selector]: opt.class}: undefined};});if(!state.tests[testId]){createTest(testId,{name: String.fromCharCode(66,117,116,116,111,110,32,84,101,115,116,58,32)+testId,variants: Object.keys(variantMap)});}return applyVariant(testId,variantMap);}function runLayoutTest(testId,selector,layouts){const variantMap={};layouts.forEach((layout,index)=>{const variantName=index===0 ? String.fromCharCode(99,111,110,116,114,111,108) : String.fromCharCode(118,97,114,105,97,110,116,95)+index;variantMap[variantName]={html:{[selector]: layout}};});if(!state.tests[testId]){createTest(testId,{name: String.fromCharCode(76,97,121,111,117,116,32,84,101,115,116,58,32)+testId,variants: Object.keys(variantMap)});}return applyVariant(testId,variantMap);}function init(options={}){if(state.initialized)return;Object.assign(config,options);loadTests();getVisitorId();state.initialized=true;log(String.fromCharCode(73,110,105,116,105,97,108,105,122,101,100));window.dispatchEvent(new CustomEvent(String.fromCharCode(97,98,84,101,115,116,82,101,97,100,121)));}window.ABTest={init: init,configure:(options)=>Object.assign(config,options),create: createTest,getVariant: getVariant,getTest:(testId)=>state.tests[testId],getAllTests:()=>({...state.tests}),apply: applyVariant,runHeadlineTest: runHeadlineTest,runButtonTest: runButtonTest,runLayoutTest: runLayoutTest,trackConversion: trackConversion,trackGoal:(testId,goalId)=>trackConversion(testId,goalId),getResults: getResults,getAllResults: getAllResults,getVisitorId: getVisitorId,reset:(testId)=>{if(testId){delete state.assignments[testId];document.cookie=config.cookiePrefix+testId+'=;expires=Thu,01 Jan 1970 00:00:00 UTC;path=/;';}else{state.assignments={};Object.keys(state.tests).forEach(id=>{document.cookie=config.cookiePrefix+id+'=;expires=Thu,01 Jan 1970 00:00:00 UTC;path=/;';});}},debug:()=>{config.debug=true;console.log(String.fromCharCode(84,101,115,116,115,58),state.tests);console.log(String.fromCharCode(65,115,115,105,103,110,109,101,110,116,115,58),state.assignments);console.log(String.fromCharCode(82,101,115,117,108,116,115,58),getAllResults());}};if(document.readyState===String.fromCharCode(108,111,97,100,105,110,103)){document.addEventListener(String.fromCharCode(68,79,77,67,111,110,116,101,110,116,76,111,97,100,101,100),()=>init());}else{init();}})();})(this);