(function(){'use strict';const config={earlyAdopterLimit: 100000,currentUsers: 0,spotsRemaining: 847,countdownEndDate: null,updateInterval: 1000,visitorKey: 'ulh_visitor_countdown',spotsKey: 'ulh_spots_remaining',pageOwner: window.AnalyticsConfig?.pageOwner||{username: 'alex',inviteCode: 'zyDK65'}};let spotsWidget=null;let countdownWidget=null;let updateTimer=null;function createStyles(){const styles=document.createElement('style');styles.textContent=` .urgency-banner{position: fixed;top: 0;left: 0;right: 0;z-index: 9990;background: linear-gradient(90deg,#ff6b6b 0%,#ff8e53 100%);padding: 10px 20px;text-align: center;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;transform: translateY(-100%);transition: transform 0.3s ease;}.urgency-banner.urgency-show{transform: translateY(0);}.urgency-banner-content{display: flex;align-items: center;justify-content: center;gap: 12px;flex-wrap: wrap;}.urgency-banner-text{color: #ffffff;font-size: 14px;font-weight: 600;}.urgency-banner-highlight{background: rgba(255,255,255,0.2);padding: 4px 12px;border-radius: 20px;font-weight: 700;}.urgency-banner-close{position: absolute;right: 12px;top: 50%;transform: translateY(-50%);background: transparent;border: none;color: #ffffff;cursor: pointer;padding: 4px;opacity: 0.7;transition: opacity 0.2s;}.urgency-banner-close:hover{opacity: 1;}.urgency-spots{position: fixed;top: 100px;right: 20px;z-index: 9980;background: linear-gradient(135deg,#1a1a2e 0%,#16213e 100%);border: 1px solid rgba(255,107,107,0.3);border-radius: 12px;padding: 16px;width: 200px;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;box-shadow: 0 10px 40px rgba(0,0,0,0.3);transform: translateX(120%);transition: transform 0.4s cubic-bezier(0.4,0,0.2,1);}.urgency-spots.urgency-show{transform: translateX(0);}.urgency-spots-header{display: flex;align-items: center;gap: 8px;margin-bottom: 12px;}.urgency-spots-dot{width: 8px;height: 8px;background: #ff6b6b;border-radius: 50%;animation: urgency-blink 1s infinite;}@keyframes urgency-blink{0%,100%{opacity: 1;}50%{opacity: 0.3;}}.urgency-spots-title{color: #ff6b6b;font-size: 11px;font-weight: 700;text-transform: uppercase;letter-spacing: 1px;}.urgency-spots-number{color: #ffffff;font-size: 36px;font-weight: 700;line-height: 1;margin-bottom: 4px;}.urgency-spots-label{color: #a0a0a0;font-size: 12px;margin-bottom: 12px;}.urgency-spots-progress{height: 6px;background: rgba(255,255,255,0.1);border-radius: 3px;overflow: hidden;margin-bottom: 12px;}.urgency-spots-progress-bar{height: 100%;background: linear-gradient(90deg,#7DF05D 0%,#ff6b6b 100%);border-radius: 3px;transition: width 0.5s ease;}.urgency-spots-cta{display: block;text-align: center;padding: 10px;background: linear-gradient(135deg,#7DF05D 0%,#5BC73F 100%);color: #1a1a2e;font-size: 12px;font-weight: 700;text-decoration: none;border-radius: 8px;transition: all 0.2s;}.urgency-spots-cta:hover{transform: scale(1.02);box-shadow: 0 4px 15px rgba(125,240,93,0.3);}.urgency-countdown{position: fixed;bottom: 100px;right: 20px;z-index: 9980;background: linear-gradient(135deg,#1a1a2e 0%,#16213e 100%);border: 1px solid rgba(125,240,93,0.3);border-radius: 12px;padding: 16px;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;box-shadow: 0 10px 40px rgba(0,0,0,0.3);transform: translateX(120%);transition: transform 0.4s cubic-bezier(0.4,0,0.2,1);}.urgency-countdown.urgency-show{transform: translateX(0);}.urgency-countdown-title{color: #7DF05D;font-size: 11px;font-weight: 700;text-transform: uppercase;letter-spacing: 1px;margin-bottom: 12px;text-align: center;}.urgency-countdown-timer{display: flex;gap: 8px;justify-content: center;}.urgency-countdown-unit{text-align: center;min-width: 50px;}.urgency-countdown-value{background: rgba(125,240,93,0.1);border: 1px solid rgba(125,240,93,0.2);border-radius: 8px;padding: 8px 4px;color: #ffffff;font-size: 24px;font-weight: 700;font-variant-numeric: tabular-nums;}.urgency-countdown-label{color: #666;font-size: 10px;margin-top: 4px;text-transform: uppercase;}.urgency-countdown-separator{color: #7DF05D;font-size: 24px;font-weight: 700;line-height: 40px;}.urgency-inline{display: inline-flex;align-items: center;gap: 16px;background: linear-gradient(135deg,rgba(255,107,107,0.1)0%,rgba(255,142,83,0.1)100%);border: 1px solid rgba(255,107,107,0.2);border-radius: 12px;padding: 12px 20px;margin: 16px 0;}.urgency-inline-icon{font-size: 24px;}.urgency-inline-content{flex: 1;}.urgency-inline-title{color: #ff6b6b;font-size: 12px;font-weight: 700;text-transform: uppercase;margin-bottom: 2px;}.urgency-inline-value{color: #ffffff;font-size: 18px;font-weight: 700;}@media(max-width: 768px){.urgency-spots,.urgency-countdown{display: none;}.urgency-banner{font-size: 12px;padding: 8px 40px 8px 12px;}}`;document.head.appendChild(styles);}function getCountdownEndDate(){const saved=localStorage.getItem(config.visitorKey);if(saved){const endDate=new Date(saved);if(endDate>new Date()){return endDate;}}const hours=24+Math.floor(Math.random()*24);const endDate=new Date(Date.now()+hours*60*60*1000);localStorage.setItem(config.visitorKey,endDate.toISOString());return endDate;}function getSpotsRemaining(){const saved=localStorage.getItem(config.spotsKey);const now=Date.now();if(saved){const data=JSON.parse(saved);const hoursPassed=(now-data.timestamp)/(1000*60*60);const decrease=Math.floor(hoursPassed*(1+Math.random()*2));const newSpots=Math.max(100,data.spots-decrease);if(newSpots!==data.spots){localStorage.setItem(config.spotsKey,JSON.stringify({spots: newSpots,timestamp: now}));}return newSpots;}const spots=500+Math.floor(Math.random()*1500);localStorage.setItem(config.spotsKey,JSON.stringify({spots: spots,timestamp: now}));return spots;}async function fetchRealSpots(){const analyticsConfig=window.AnalyticsConfig;if(!analyticsConfig||!analyticsConfig.endpoints)return;const backend=analyticsConfig.backend;const endpoint=analyticsConfig.endpoints[backend];if(!endpoint||!endpoint.url||endpoint.url.includes('%'))return;try{let url;let headers={'Content-Type': 'application/json'};if(backend==='supabase'){url=`${endpoint.url}/rest/v1/users?is_early_adopter=eq.true&select=count`;headers['apikey']=endpoint.anonKey;headers['Authorization']=`Bearer ${endpoint.anonKey}`;headers['Prefer']='count=exact';const response=await fetch(url,{headers,method: 'HEAD'});const count=parseInt(response.headers.get('content-range')?.split('/')[1]||'0');config.currentUsers=count;config.spotsRemaining=Math.max(0,config.earlyAdopterLimit-count);}}catch(error){console.log('Urgency: Using simulated spots');}}function createBanner(){const spots=getSpotsRemaining();const banner=document.createElement('div');banner.className='urgency-banner';banner.innerHTML=`<div class="urgency-banner-content"><span class="urgency-banner-text">Early Adopter Bonus:<span class="urgency-banner-highlight">2X Commissions!</span>Only<span class="urgency-banner-highlight" id="urgency-banner-spots">${spots.toLocaleString()}</span>spots left!</span></div><button class="urgency-banner-close" aria-label="Close"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button>`;banner.querySelector('.urgency-banner-close').addEventListener('click',()=>{banner.classList.remove('urgency-show');document.body.style.paddingTop='0';});document.body.appendChild(banner);setTimeout(()=>{banner.classList.add('urgency-show');document.body.style.paddingTop='44px';},1000);return banner;}function createSpotsWidget(){const spots=getSpotsRemaining();const progress=((config.earlyAdopterLimit-spots)/config.earlyAdopterLimit)*100;const signupUrl=`https://app.unilivehub.com/signup?ref=${config.pageOwner.username}&code=${config.pageOwner.inviteCode}`;spotsWidget=document.createElement('div');spotsWidget.className='urgency-spots';spotsWidget.innerHTML=`<div class="urgency-spots-header"><span class="urgency-spots-dot"></span><span class="urgency-spots-title">Limited Spots</span></div><div class="urgency-spots-number" id="urgency-spots-count">${spots.toLocaleString()}</div><div class="urgency-spots-label">Early adopter spots remaining</div><div class="urgency-spots-progress"><div class="urgency-spots-progress-bar" style="width: ${progress}%"></div></div><a href="${signupUrl}" class="urgency-spots-cta">Claim Your Spot</a>`;document.body.appendChild(spotsWidget);setTimeout(()=>{spotsWidget.classList.add('urgency-show');},5000);}function createCountdownWidget(){const endDate=getCountdownEndDate();countdownWidget=document.createElement('div');countdownWidget.className='urgency-countdown';countdownWidget.innerHTML=`<div class="urgency-countdown-title">Bonus Expires In</div><div class="urgency-countdown-timer" id="urgency-countdown-timer"><div class="urgency-countdown-unit"><div class="urgency-countdown-value" id="countdown-hours">00</div><div class="urgency-countdown-label">Hours</div></div><span class="urgency-countdown-separator">:</span><div class="urgency-countdown-unit"><div class="urgency-countdown-value" id="countdown-minutes">00</div><div class="urgency-countdown-label">Mins</div></div><span class="urgency-countdown-separator">:</span><div class="urgency-countdown-unit"><div class="urgency-countdown-value" id="countdown-seconds">00</div><div class="urgency-countdown-label">Secs</div></div></div>`;document.body.appendChild(countdownWidget);setTimeout(()=>{countdownWidget.classList.add('urgency-show');},8000);updateCountdown(endDate);}function updateCountdown(endDate){function update(){const now=new Date();const diff=endDate-now;if(diff<=0){const newEndDate=getCountdownEndDate();localStorage.removeItem(config.visitorKey);updateCountdown(getCountdownEndDate());return;}const hours=Math.floor(diff/(1000*60*60));const minutes=Math.floor((diff %(1000*60*60))/(1000*60));const seconds=Math.floor((diff %(1000*60))/1000);const hoursEl=document.getElementById('countdown-hours');const minutesEl=document.getElementById('countdown-minutes');const secondsEl=document.getElementById('countdown-seconds');if(hoursEl)hoursEl.textContent=hours.toString().padStart(2,'0');if(minutesEl)minutesEl.textContent=minutes.toString().padStart(2,'0');if(secondsEl)secondsEl.textContent=seconds.toString().padStart(2,'0');}update();updateTimer=setInterval(update,1000);}function startSpotsSimulation(){setInterval(()=>{const spots=getSpotsRemaining();const bannerSpots=document.getElementById('urgency-banner-spots');if(bannerSpots)bannerSpots.textContent=spots.toLocaleString();const widgetSpots=document.getElementById('urgency-spots-count');if(widgetSpots)widgetSpots.textContent=spots.toLocaleString();const progress=((config.earlyAdopterLimit-spots)/config.earlyAdopterLimit)*100;const progressBar=document.querySelector('.urgency-spots-progress-bar');if(progressBar)progressBar.style.width=`${progress}%`;},30000);}function init(){createStyles();fetchRealSpots();createBanner();createSpotsWidget();createCountdownWidget();startSpotsSimulation();}if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',init);}else{init();}window.Urgency={getSpots: getSpotsRemaining,getCountdownEnd: getCountdownEndDate,reset:()=>{localStorage.removeItem(config.visitorKey);localStorage.removeItem(config.spotsKey);location.reload();},hide:()=>{if(spotsWidget)spotsWidget.classList.remove('urgency-show');if(countdownWidget)countdownWidget.classList.remove('urgency-show');document.querySelector('.urgency-banner')?.classList.remove('urgency-show');},show:()=>{if(spotsWidget)spotsWidget.classList.add('urgency-show');if(countdownWidget)countdownWidget.classList.add('urgency-show');document.querySelector('.urgency-banner')?.classList.add('urgency-show');}};})();