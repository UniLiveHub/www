(function(){'use strict';const config={apiEndpoint: '/api/leads/capture',formPosition: 'inline',showAfterScroll: 50,showAfterTime: 30000,enableQuiz: true,quizSteps: 3,leadMagnet:{title: 'Free Guide: 10 Steps to Financial Freedom',description: 'Learn how to build passive income with UniLiveHub',downloadUrl: '#'},cookieName: 'ulh_lead_captured',cookieDays: 30,primaryColor: '#7DF05D',backgroundColor: '#0A0A0A',trackingEnabled: true};let state={formShown: false,quizStep: 0,quizAnswers:{},leadCaptured: false,scrollTriggered: false,timeTriggered: false};const styles=` .lc-container{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;box-sizing: border-box;}.lc-container*{box-sizing: border-box;}.lc-inline-form{background: linear-gradient(135deg,#1a1a2e 0%,#16213e 100%);border: 1px solid rgba(125,240,93,0.2);border-radius: 16px;padding: 32px;margin: 32px 0;text-align: center;}.lc-inline-form h3{color: #ffffff;font-size: 24px;font-weight: 700;margin: 0 0 8px 0;}.lc-inline-form p{color: #a0a0a0;font-size: 14px;margin: 0 0 24px 0;}.lc-form-row{display: flex;gap: 12px;max-width: 500px;margin: 0 auto;}.lc-input{flex: 1;padding: 14px 18px;border: 1px solid rgba(255,255,255,0.1);border-radius: 8px;background: rgba(255,255,255,0.05);color: #ffffff;font-size: 15px;outline: none;transition: border-color 0.2s,background 0.2s;}.lc-input:focus{border-color: ${config.primaryColor};background: rgba(255,255,255,0.08);}.lc-input::placeholder{color: #666;}.lc-submit-btn{padding: 14px 28px;background: ${config.primaryColor};color: #0A0A0A;border: none;border-radius: 8px;font-size: 15px;font-weight: 600;cursor: pointer;transition: transform 0.2s,box-shadow 0.2s;white-space: nowrap;}.lc-submit-btn:hover{transform: translateY(-2px);box-shadow: 0 4px 20px rgba(125,240,93,0.3);}.lc-submit-btn:disabled{opacity: 0.6;cursor: not-allowed;transform: none;}.lc-privacy{color: #666;font-size: 12px;margin-top: 16px;}.lc-privacy a{color: ${config.primaryColor};text-decoration: none;}.lc-popup-overlay{position: fixed;top: 0;left: 0;right: 0;bottom: 0;background: rgba(0,0,0,0.85);backdrop-filter: blur(4px);z-index: 999999;display: flex;align-items: center;justify-content: center;opacity: 0;visibility: hidden;transition: opacity 0.3s,visibility 0.3s;}.lc-popup-overlay.lc-visible{opacity: 1;visibility: visible;}.lc-popup-content{background: linear-gradient(135deg,#1a1a2e 0%,#0f0f23 100%);border: 1px solid rgba(125,240,93,0.3);border-radius: 20px;padding: 40px;max-width: 480px;width: 90%;position: relative;transform: scale(0.9)translateY(20px);transition: transform 0.3s;box-shadow: 0 25px 50px rgba(0,0,0,0.5);}.lc-popup-overlay.lc-visible .lc-popup-content{transform: scale(1)translateY(0);}.lc-popup-close{position: absolute;top: 16px;right: 16px;width: 32px;height: 32px;background: rgba(255,255,255,0.1);border: none;border-radius: 50%;color: #fff;font-size: 20px;cursor: pointer;display: flex;align-items: center;justify-content: center;transition: background 0.2s;}.lc-popup-close:hover{background: rgba(255,255,255,0.2);}.lc-popup-icon{width: 64px;height: 64px;background: linear-gradient(135deg,${config.primaryColor},#4ade80);border-radius: 16px;display: flex;align-items: center;justify-content: center;margin: 0 auto 24px;}.lc-popup-icon svg{width: 32px;height: 32px;}.lc-popup-title{color: #ffffff;font-size: 28px;font-weight: 700;margin: 0 0 12px 0;text-align: center;}.lc-popup-subtitle{color: #a0a0a0;font-size: 16px;margin: 0 0 28px 0;text-align: center;line-height: 1.5;}.lc-popup-form{display: flex;flex-direction: column;gap: 12px;}.lc-popup-form .lc-input{width: 100%;}.lc-popup-form .lc-submit-btn{width: 100%;}.lc-slide-in{position: fixed;bottom: 24px;right:-400px;width: 360px;background: linear-gradient(135deg,#1a1a2e 0%,#0f0f23 100%);border: 1px solid rgba(125,240,93,0.3);border-radius: 16px;padding: 24px;z-index: 999998;transition: right 0.4s ease-out;box-shadow: 0 10px 40px rgba(0,0,0,0.3);}.lc-slide-in.lc-visible{right: 24px;}.lc-slide-in-close{position: absolute;top: 12px;right: 12px;width: 28px;height: 28px;background: rgba(255,255,255,0.1);border: none;border-radius: 50%;color: #fff;font-size: 16px;cursor: pointer;display: flex;align-items: center;justify-content: center;}.lc-slide-in h4{color: #ffffff;font-size: 18px;font-weight: 600;margin: 0 0 8px 0;}.lc-slide-in p{color: #a0a0a0;font-size: 13px;margin: 0 0 16px 0;}.lc-slide-in .lc-input{width: 100%;margin-bottom: 12px;}.lc-slide-in .lc-submit-btn{width: 100%;}.lc-quiz{background: linear-gradient(135deg,#1a1a2e 0%,#16213e 100%);border: 1px solid rgba(125,240,93,0.2);border-radius: 20px;padding: 40px;margin: 32px 0;max-width: 600px;margin-left: auto;margin-right: auto;}.lc-quiz-progress{display: flex;gap: 8px;margin-bottom: 32px;}.lc-quiz-step{flex: 1;height: 4px;background: rgba(255,255,255,0.1);border-radius: 2px;transition: background 0.3s;}.lc-quiz-step.lc-active{background: ${config.primaryColor};}.lc-quiz-step.lc-completed{background: ${config.primaryColor};}.lc-quiz-question{color: #ffffff;font-size: 22px;font-weight: 600;margin: 0 0 24px 0;text-align: center;}.lc-quiz-options{display: flex;flex-direction: column;gap: 12px;}.lc-quiz-option{padding: 16px 20px;background: rgba(255,255,255,0.05);border: 1px solid rgba(255,255,255,0.1);border-radius: 12px;color: #ffffff;font-size: 15px;cursor: pointer;transition: all 0.2s;text-align: left;}.lc-quiz-option:hover{background: rgba(125,240,93,0.1);border-color: rgba(125,240,93,0.3);}.lc-quiz-option.lc-selected{background: rgba(125,240,93,0.15);border-color: ${config.primaryColor};}.lc-quiz-result{text-align: center;}.lc-quiz-result-icon{width: 80px;height: 80px;background: linear-gradient(135deg,${config.primaryColor},#4ade80);border-radius: 50%;display: flex;align-items: center;justify-content: center;margin: 0 auto 24px;}.lc-quiz-result h3{color: ${config.primaryColor};font-size: 36px;font-weight: 700;margin: 0 0 8px 0;}.lc-quiz-result p{color: #a0a0a0;font-size: 16px;margin: 0 0 24px 0;}.lc-success{text-align: center;padding: 20px;}.lc-success-icon{width: 64px;height: 64px;background: linear-gradient(135deg,${config.primaryColor},#4ade80);border-radius: 50%;display: flex;align-items: center;justify-content: center;margin: 0 auto 16px;}.lc-success h4{color: #ffffff;font-size: 20px;font-weight: 600;margin: 0 0 8px 0;}.lc-success p{color: #a0a0a0;font-size: 14px;margin: 0;}.lc-loading{display: inline-block;width: 20px;height: 20px;border: 2px solid rgba(0,0,0,0.1);border-left-color: #0A0A0A;border-radius: 50%;animation: lc-spin 0.8s linear infinite;}@keyframes lc-spin{to{transform: rotate(360deg);}}@media(max-width: 640px){.lc-form-row{flex-direction: column;}.lc-popup-content{padding: 28px 20px;}.lc-popup-title{font-size: 22px;}.lc-slide-in{width: calc(100%-32px);right:-100%;bottom: 16px;}.lc-slide-in.lc-visible{right: 16px;}.lc-quiz{padding: 24px;}.lc-quiz-question{font-size: 18px;}}`;const quizQuestions=[{question: 'What is your main goal?',options:[{value: 'passive_income',label: 'Build passive income'},{value: 'side_hustle',label: 'Start a side hustle'},{value: 'full_time',label: 'Replace my full-time income'},{value: 'financial_freedom',label: 'Achieve financial freedom'}]},{question: 'How much time can you invest weekly?',options:[{value: '1-5',label: '1-5 hours'},{value: '5-10',label: '5-10 hours'},{value: '10-20',label: '10-20 hours'},{value: '20+',label: '20+hours'}]},{question: 'Do you have experience with affiliate marketing?',options:[{value: 'none',label: 'No experience'},{value: 'beginner',label: 'Some experience'},{value: 'intermediate',label: 'Intermediate'},{value: 'advanced',label: 'Advanced'}]}];function setCookie(name,value,days){const expires=new Date(Date.now()+days*864e5).toUTCString();document.cookie=name+'='+encodeURIComponent(value)+';expires='+expires+';path=/';}function getCookie(name){return document.cookie.split(';').reduce((r,v)=>{const parts=v.split('=');return parts[0]===name ? decodeURIComponent(parts[1]): r;},'');}function validateEmail(email){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);}function trackEvent(eventName,data={}){if(!config.trackingEnabled)return;if(window.UniLiveAnalytics&&typeof window.UniLiveAnalytics.trackEvent==='function'){window.UniLiveAnalytics.trackEvent(eventName,data);}window.dispatchEvent(new CustomEvent('leadCapture:'+eventName,{detail: data}));}function getPageOwner(){const pathParts=window.location.pathname.split('/').filter(Boolean);return pathParts[0]||'unknown';}function injectStyles(){if(document.getElementById('lc-styles'))return;const styleEl=document.createElement('style');styleEl.id='lc-styles';styleEl.textContent=styles;document.head.appendChild(styleEl);}function createInlineForm(targetSelector){const target=document.querySelector(targetSelector);if(!target)return;const container=document.createElement('div');container.className='lc-container lc-inline-form';container.id='lc-inline-form';container.innerHTML=\`<h3>Get Your Free Guide</h3><p>\${config.leadMagnet.description}</p><form class="lc-form-row" onsubmit="return false;"><input type="email" class="lc-input" placeholder="Enter your email" required><button type="submit" class="lc-submit-btn">Get Free Guide</button></form><p class="lc-privacy">We respect your privacy.<a href="/privacy">Privacy Policy</a></p>\`;const form=container.querySelector('form');const input=container.querySelector('input');const button=container.querySelector('button');form.addEventListener('submit',async(e)=>{e.preventDefault();await handleSubmit(input.value,button,container,'inline');});target.appendChild(container);trackEvent('lead_form_shown',{type: 'inline'});}function createPopupForm(){if(document.getElementById('lc-popup'))return;const overlay=document.createElement('div');overlay.className='lc-container lc-popup-overlay';overlay.id='lc-popup';overlay.innerHTML=\`<div class="lc-popup-content"><button class="lc-popup-close">&times;</button><div class="lc-popup-icon"><svg viewBox="0 0 24 24" fill="none" stroke="#0A0A0A" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg></div><h2 class="lc-popup-title">\${config.leadMagnet.title}</h2><p class="lc-popup-subtitle">\${config.leadMagnet.description}</p><form class="lc-popup-form" onsubmit="return false;"><input type="text" class="lc-input" placeholder="Your name" required><input type="email" class="lc-input" placeholder="Your email" required><button type="submit" class="lc-submit-btn">Get Free Access</button></form><p class="lc-privacy" style="text-align:center;">No spam. Unsubscribe anytime.</p></div>\`;const closeBtn=overlay.querySelector('.lc-popup-close');const form=overlay.querySelector('form');const emailInput=overlay.querySelectorAll('input')[1];const button=overlay.querySelector('button[type="submit"]');const content=overlay.querySelector('.lc-popup-content');closeBtn.addEventListener('click',()=>hidePopup());overlay.addEventListener('click',(e)=>{if(e.target===overlay)hidePopup();});form.addEventListener('submit',async(e)=>{e.preventDefault();await handleSubmit(emailInput.value,button,content,'popup');});document.body.appendChild(overlay);}function showPopup(){const popup=document.getElementById('lc-popup');if(popup&&!state.leadCaptured){popup.classList.add('lc-visible');state.formShown=true;trackEvent('lead_form_shown',{type: 'popup'});}}function hidePopup(){const popup=document.getElementById('lc-popup');if(popup){popup.classList.remove('lc-visible');trackEvent('lead_form_dismissed',{type: 'popup'});}}function createSlideInForm(){if(document.getElementById('lc-slide-in'))return;const slideIn=document.createElement('div');slideIn.className='lc-container lc-slide-in';slideIn.id='lc-slide-in';slideIn.innerHTML=\`<button class="lc-slide-in-close">&times;</button><h4>Don't Miss Out!</h4><p>Get our free guide and start earning today.</p><form onsubmit="return false;"><input type="email" class="lc-input" placeholder="Your email" required><button type="submit" class="lc-submit-btn">Get Free Guide</button></form>\`;const closeBtn=slideIn.querySelector('.lc-slide-in-close');const form=slideIn.querySelector('form');const input=slideIn.querySelector('input');const button=slideIn.querySelector('button[type="submit"]');closeBtn.addEventListener('click',()=>{slideIn.classList.remove('lc-visible');trackEvent('lead_form_dismissed',{type: 'slide-in'});});form.addEventListener('submit',async(e)=>{e.preventDefault();await handleSubmit(input.value,button,slideIn,'slide-in');});document.body.appendChild(slideIn);}function showSlideIn(){const slideIn=document.getElementById('lc-slide-in');if(slideIn&&!state.leadCaptured&&!state.formShown){slideIn.classList.add('lc-visible');state.formShown=true;trackEvent('lead_form_shown',{type: 'slide-in'});}}function createQuiz(targetSelector){const target=document.querySelector(targetSelector);if(!target)return;const quiz=document.createElement('div');quiz.className='lc-container lc-quiz';quiz.id='lc-quiz';renderQuizStep(quiz,0);target.appendChild(quiz);trackEvent('quiz_started');}function renderQuizStep(container,step){if(step>=quizQuestions.length){renderQuizResult(container);return;}const question=quizQuestions[step];container.innerHTML=\`<div class="lc-quiz-progress">\${quizQuestions.map((_,i)=>\`<div class="lc-quiz-step \${i<step ? 'lc-completed' : ''}\${i===step ? 'lc-active' : ''}"></div>\`).join('')}</div><h3 class="lc-quiz-question">\${question.question}</h3><div class="lc-quiz-options">\${question.options.map(opt=>\`<button class="lc-quiz-option" data-value="\${opt.value}">\${opt.label}</button>\`).join('')}</div>\`;container.querySelectorAll('.lc-quiz-option').forEach(btn=>{btn.addEventListener('click',()=>{state.quizAnswers[step]=btn.dataset.value;state.quizStep=step+1;trackEvent('quiz_step_completed',{step: step+1,answer: btn.dataset.value});renderQuizStep(container,step+1);});});}function renderQuizResult(container){const timeValue=state.quizAnswers[1];let earnings=0;switch(timeValue){case '1-5': earnings=500;break;case '5-10': earnings=1500;break;case '10-20': earnings=3000;break;case '20+': earnings=5000;break;default: earnings=1000;}container.innerHTML=\`<div class="lc-quiz-result"><div class="lc-quiz-result-icon"><svg viewBox="0 0 24 24" fill="none" stroke="#0A0A0A" stroke-width="2" width="40" height="40"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></div><h3>$\${earnings.toLocaleString()}/mo</h3><p>Your estimated earning potential with UniLiveHub</p><form onsubmit="return false;"><input type="email" class="lc-input" placeholder="Enter email for personalized plan" required style="margin-bottom: 12px;"><button type="submit" class="lc-submit-btn" style="width: 100%;">Get My Personalized Plan</button></form></div>\`;const form=container.querySelector('form');const input=container.querySelector('input');const button=container.querySelector('button');form.addEventListener('submit',async(e)=>{e.preventDefault();await handleSubmit(input.value,button,container,'quiz',{quizAnswers: state.quizAnswers,estimatedEarnings: earnings});});trackEvent('quiz_completed',{estimatedEarnings: earnings});}async function handleSubmit(email,button,container,source,extraData={}){if(!validateEmail(email)){alert('Please enter a valid email address');return;}const originalText=button.innerHTML;button.innerHTML='<span class="lc-loading"></span>';button.disabled=true;try{const payload={email: email,source: source,pageOwner: getPageOwner(),referralCode: localStorage.getItem('unilive_referral_code')||'',...extraData};if(config.apiEndpoint){try{const response=await fetch(config.apiEndpoint,{method: 'POST',headers:{'Content-Type': 'application/json'},body: JSON.stringify(payload)});if(!response.ok){throw new Error('API error');}}catch(apiError){console.log('LeadCapture: Backend not available,storing locally');const leads=JSON.parse(localStorage.getItem('ulh_captured_leads')||'[]');leads.push({...payload,timestamp: Date.now()});localStorage.setItem('ulh_captured_leads',JSON.stringify(leads));}}state.leadCaptured=true;setCookie(config.cookieName,email,config.cookieDays);showSuccess(container);trackEvent('lead_captured',{source: source,email: email.split('@')[1]});if(source==='popup'){setTimeout(()=>hidePopup(),2000);}}catch(error){console.error('LeadCapture: Error submitting lead',error);button.innerHTML=originalText;button.disabled=false;alert('Something went wrong. Please try again.');}}function showSuccess(container){const successHTML=\`<div class="lc-success"><div class="lc-success-icon"><svg viewBox="0 0 24 24" fill="none" stroke="#0A0A0A" stroke-width="3" width="32" height="32"><polyline points="20 6 9 17 4 12"/></svg></div><h4>You're In!</h4><p>Check your email for your free guide.</p></div>\`;if(container.classList.contains('lc-popup-content')){container.innerHTML=successHTML;}else if(container.classList.contains('lc-slide-in')){container.querySelector('form').outerHTML=successHTML;}else if(container.classList.contains('lc-inline-form')){container.querySelector('form').outerHTML=successHTML;}else if(container.classList.contains('lc-quiz')){container.innerHTML=successHTML;}}function setupScrollTrigger(){let lastScrollPercent=0;window.addEventListener('scroll',()=>{if(state.scrollTriggered||state.leadCaptured)return;const scrollPercent=(window.scrollY/(document.body.scrollHeight-window.innerHeight))*100;if(scrollPercent>=config.showAfterScroll&&scrollPercent>lastScrollPercent){state.scrollTriggered=true;if(config.formPosition==='popup'){showPopup();}else if(config.formPosition==='slide-in'){showSlideIn();}}lastScrollPercent=scrollPercent;});}function setupTimeTrigger(){setTimeout(()=>{if(state.timeTriggered||state.leadCaptured||state.formShown)return;state.timeTriggered=true;if(config.formPosition==='popup'){showPopup();}else if(config.formPosition==='slide-in'){showSlideIn();}},config.showAfterTime);}function init(options={}){Object.assign(config,options);if(getCookie(config.cookieName)){state.leadCaptured=true;return;}injectStyles();if(config.formPosition==='popup'){createPopupForm();setupScrollTrigger();setupTimeTrigger();}else if(config.formPosition==='slide-in'){createSlideInForm();setupScrollTrigger();setupTimeTrigger();}console.log('LeadCapture: Initialized');}window.LeadCapture={init: init,configure:(options)=>Object.assign(config,options),createInlineForm: createInlineForm,createPopupForm: createPopupForm,createSlideInForm: createSlideInForm,showPopup: showPopup,hidePopup: hidePopup,showSlideIn: showSlideIn,createQuiz: createQuiz,isLeadCaptured:()=>state.leadCaptured,reset:()=>{state.leadCaptured=false;document.cookie=config.cookieName+'=;expires=Thu,01 Jan 1970 00:00:00 UTC;path=/;';},getConfig:()=>({...config}),getState:()=>({...state})};if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',()=>init());}else{init();}})();